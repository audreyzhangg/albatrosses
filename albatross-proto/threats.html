<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Albatross Threats Matrix</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
  <style>
    :root{
      --ink:#0f172a;
      --ink-2:#1f2937;
      --muted:#6b7280;
      --chip:#f3f4f6;
      --chip-b:#e5e7eb;
      --chip-act:#e8f0ff;
      --chip-act-b:#bfdbfe;
    }

    body{
      margin:0;
      padding:20px;
      font-family: ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
      background:#fff;
      color:var(--ink);
    }

    .container{ max-width:1400px; margin:0 auto; }

    h1{
      text-align:center;
      color:#2c3e50;
      margin:20px 0 10px 0;
      font-size:28px;
    }
    .subtitle{
      text-align:center;
      color:#7f8c8d;
      margin:0 0 12px 0;
      font-size:16px;
    }

    /* Site navigation bar (same style as other pages) */
    .site-nav{
      display:flex; justify-content:center; gap:10px; flex-wrap:wrap;
      margin:8px auto 18px; padding:6px 0 14px; position:relative;
      max-width:1400px;
    }
    .site-nav::after{
      content:""; position:absolute; left:0; right:0; bottom:0; height:3px;
      background: linear-gradient(90deg,#c7d2fe,#fbcfe8);
      opacity:.6;
    }
    .site-nav a{
      display:inline-flex; align-items:center; gap:8px;
      padding:8px 14px; border-radius:999px;
      background:var(--chip); border:1px solid var(--chip-b);
      color:var(--ink-2); text-decoration:none; font-weight:600; font-size:14px;
      box-shadow:0 1px 0 rgba(15,23,42,.06), inset 0 -1px 0 rgba(255,255,255,.7);
      transition:transform .05s ease, background .15s ease, box-shadow .15s ease;
    }
    .site-nav a:hover{ transform:translateY(-1px); background:#eef2f7; }
    .site-nav a.active{
      background:var(--chip-act); border-color:var(--chip-act-b); color:var(--ink);
      box-shadow:0 2px 6px rgba(59,130,246,.15), inset 0 -1px 0 rgba(255,255,255,.75);
    }

    #matrix-viz{ 
      overflow-x: auto; 
      overflow-y: visible;
      display: flex;
      justify-content: center;
      width: 100%;
    }

    #matrix-viz svg {
      max-width: 100%;
    }

    .species-label{ font-size:13px; fill:#2c3e50; text-anchor:end; }
    .threat-label{ font-size:12px; fill:#2c3e50; text-anchor:start; }

    .matrix-circle{ cursor:pointer; }

    .grid-line{ stroke:#ecf0f1; stroke-width:1; }

    .tooltip{
      position:absolute; background:rgba(0,0,0,0.85); color:#fff;
      padding:8px 10px; border-radius:4px; font-size:13px;
      pointer-events:none; z-index:9999; display:none; max-width:300px;
    }

    .legend{
      display:flex; justify-content:center; gap:20px; margin-bottom:20px; flex-wrap:wrap; align-items:center;
    }
    .legend-item{ display:flex; align-items:center; gap:8px; font-size:14px; }
    .legend-circle{ border-radius:50%; background:#888; }
  </style>
</head>
<body>
  <div class="container">
    <!-- Original title and subtitle (unchanged) -->
    <h1>Albatross Species Threats Matrix</h1>
    <p class="subtitle">Each circle represents a threat affecting a species. Hover for details.</p>

    <!-- New navigation bar (Threats is active) -->
    <nav class="site-nav" aria-label="Primary">
      <a href="intro.html">Intro</a>
      <a href="species.html">Species</a>
      <a href="colonies.html">Migration</a>
      <a href="threats.html" class="active">Threats</a>
      <a href="myths.html">Myths</a>
    </nav>

    <!-- Conservation Status Legend -->
    <div style="margin-bottom: 15px;">
      <div style="text-align: center; font-weight: 600; margin-bottom: 10px; color: #2c3e50;">Conservation Status</div>
      <div class="legend">
        <div class="legend-item">
          <div class="legend-circle" style="width:12px; height:12px; background:#d32f2f;"></div><span>Critically Endangered</span>
        </div>
        <div class="legend-item">
          <div class="legend-circle" style="width:12px; height:12px; background:#f57c00;"></div><span>Endangered</span>
        </div>
        <div class="legend-item">
          <div class="legend-circle" style="width:12px; height:12px; background:#fbc02d;"></div><span>Vulnerable</span>
        </div>
        <div class="legend-item">
          <div class="legend-circle" style="width:12px; height:12px; background:#388e3c;"></div><span>Near Threatened</span>
        </div>
        <div class="legend-item">
          <div class="legend-circle" style="width:12px; height:12px; background:#1976d2;"></div><span>Least Concern</span>
        </div>
      </div>
    </div>
    
    <!-- Threat Impact Legend -->
    <div style="margin-bottom: 20px;">
      <div style="text-align: center; font-weight: 600; margin-bottom: 10px; color: #2c3e50;">Threat Impact</div>
      <div class="legend">
        <div class="legend-item">
          <div class="legend-circle" style="width:16px; height:16px;"></div><span>High Impact</span>
        </div>
        <div class="legend-item">
          <div class="legend-circle" style="width:12px; height:12px;"></div><span>Medium Impact</span>
        </div>
        <div class="legend-item">
          <div class="legend-circle" style="width:8px; height:8px;"></div><span>Low Impact</span>
        </div>
      </div>
    </div>

    <div id="matrix-viz"></div>
  </div>

  <script src="threats.js"></script>
</body>
</html>
