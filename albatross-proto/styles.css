/* ===== playful palette ===== */
:root{
    --ink:#0b1220;
    --ink-soft:#43526a;
    --bg:#f9fafb;
    --card:#ffffff;
    --border:#e5e7eb;
    --primary:#6d28d9;
    --accent:#06b6d4;
    --pop:#ec4899;
  }
  
  *{box-sizing:border-box}
  body{font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;font-size:large;margin:0;padding:0;color:#2c3e50;background:linear-gradient(180deg,#f0f9ff 0%, #e0f2fe 60%, #ffffff 100%)}
  
  /* Header with a soft gradient stripe */
  header{
    padding:16px 20px 18px;
    background:var(--card);
    border-bottom:1px solid var(--border);
    position:relative;
    text-align:center;
  }
  header::after{
    content:"";
    position:absolute; left:0; right:0; bottom:-2px; height:6px;
    background:linear-gradient(90deg,var(--primary),var(--accent),var(--pop));
    opacity:.35;
  }
  h1{margin:0 0 6px 0;font-size:24px;color:#2c3e50}
  .deck{margin:0;font-size:18px;color:#7f8c8d}
  .subtitle{margin:0 0 12px 0;font-size:18px;color:#7f8c8d}

  /* Top navigation (match species.html pills) */
  .topnav{margin-top:10px; display:flex; gap:12px; flex-wrap:wrap; justify-content:center}
  .topnav a{
    text-decoration:none; color:#334155; padding:6px 10px; border-radius:999px;
    border:1px solid var(--border); background:#fff; font-size:14px;
  }
  .topnav a.active{border-color:var(--accent); background:color-mix(in srgb, var(--accent) 14%, #fff)}
  
  .controls{
    display:flex; gap:16px; align-items:center; flex-wrap:wrap;
    padding:12px 20px; background:var(--card); border-bottom:1px solid var(--border);
  }
  .controls label{display:flex; align-items:center; gap:8px}
  .controls select{
    padding:6px 10px; border-radius:10px; border:1px solid var(--border); background:#fff;
  }
  
  /* Layout */
  main{
    display:grid; grid-template-columns:1fr 340px; gap:14px; padding:14px 20px;
  }
  #map{
    width:100%; height:auto; background:#e6f0f8;
    border:1px solid var(--border); border-radius:14px;
    box-shadow:0 6px 18px rgba(0,0,0,.04);
  }
  #notes{
    display:flex; flex-direction:column; gap:12px;
  }
  
  /* Cards in sidebar */
  .card{
    background:var(--card); border:1px solid var(--border); border-radius:14px;
    padding:10px 12px; box-shadow:0 6px 18px rgba(0,0,0,.04);
  }
  #speciesTitle{margin:0 0 4px 0}
  #speciesPhoto{
    width:100%; height:220px; object-fit:cover; border-radius:12px; display:none;
    box-shadow:0 6px 18px rgba(0,0,0,.08);
  }
  
  /* Map base */
  .country{fill:#fff;stroke:#cbd5e1;stroke-width:.5}
  .graticule{fill:none;stroke:#bfdbfe;stroke-width:.5;opacity:.6}
  
  /* Colonies â€” cheerful blue with highlight state */
  .colony{
    fill:#2563eb; fill-opacity:.88; stroke:#0f172a; stroke-width:.5; stroke-opacity:.25;
    transition: r .2s ease, stroke-width .2s ease, filter .2s ease;
  }
  .colony.highlight{stroke-width:1.6; filter:drop-shadow(0 0 6px rgba(37,99,235,.6))}
  
  /* Colony list */
  .colony-list{
    list-style:none; padding:0; margin:8px 0 0 0; max-height:230px; overflow:auto;
  }
  .colony-list li{
    padding:8px 10px; margin:0 0 6px 0; border:1px dashed var(--border); border-radius:10px; background:#fff;
    cursor:pointer; transition: border-color .15s ease, background .15s ease;
  }
  .colony-list li:hover{border-color:var(--accent); background:color-mix(in srgb, var(--accent) 14%, #fff)}
  .colony-list .name{font-weight:600}
  .colony-list .meta{color:var(--ink-soft); font-size:12px}
  .hint{color:var(--ink-soft); font-size:12px; margin:6px 0 0 0}
  
/* --- Carousel layout & animation --- */
.pc-stage{
    position:relative; border:1px solid var(--border); border-radius:14px; background:#fff;
    overflow:hidden; box-shadow:0 8px 24px rgba(0,0,0,.05);
  }
  .pc-viewport{
    overflow-x:auto; overflow-y:hidden;
    scroll-snap-type: x mandatory;
    scroll-behavior: smooth;
    scrollbar-width:none;
  }
  .pc-viewport::-webkit-scrollbar{ display:none; }
  .pc-track{ display:flex; gap:18px; padding:18px; }
  
  .pc-card{
    flex: 0 0 100%;
    scroll-snap-align: start;
    border:2px solid #0f172a; border-radius:12px; background:#fff; min-height:320px;
    box-shadow:0 10px 24px rgba(0,0,0,.06);
    display:grid; grid-template-columns: 1fr 2px 420px; gap:0;
  }
  .pc-left{ position:relative; padding:18px 18px 22px 30px; }
  .pc-lines{ position:absolute; left:10px; top:12px; bottom:12px; width:10px;
    background: linear-gradient(#0f172a 2px, transparent 2px) 0 18px / 10px 22px repeat-y;
    opacity:.25;
  }
  .pc-kicker{ margin:0 0 6px; font-size:14px; color:#64748b; }
  .pc-text p{ margin:0; font-size:16px; line-height:1.5; color:#0b1220; }
  .pc-divider{ background:#0f172a; opacity:.35; width:2px; }
  .pc-right{ position:relative; padding:16px; display:grid; grid-template-rows: 90px 1fr; }
  .pc-stamp{ width:78px; height:78px; justify-self:end; border-radius:10px;
    background-size:cover; background-position:center; box-shadow:0 4px 12px rgba(0,0,0,.15);
  }
  .pc-stamp-ph{ background:linear-gradient(135deg,#e2e8f0,#f1f5f9); border:1px dashed #cbd5e1; }
  .pc-meta{ align-self:start; margin-top:8px; }
  .pc-title{ font-weight:800; font-size:22px; margin-bottom:6px; }
  .pc-country{ font-weight:700; color:#334155; margin-bottom:4px; }
  .pc-source{ font-size:13px; color:#64748b; }
  
  .carousel-btn{
    position:absolute; top:50%; transform:translateY(-50%); z-index:2;
    width:46px; height:46px; border-radius:999px; border:1px solid var(--border);
    background:#fff; box-shadow:0 6px 16px rgba(0,0,0,.12);
    font-size:28px; line-height:1; color:#0f172a; cursor:pointer;
  }
  .carousel-btn:hover{ background:color-mix(in srgb, var(--accent) 10%, #fff); }
  .carousel-btn.prev{ left:12px; }
  .carousel-btn.next{ right:12px; }
  
  .pc-footer{ margin-top:10px; display:flex; gap:12px; align-items:center; }
  .pc-counter{ font-weight:600; color:#334155; }
  
  @media (max-width: 980px){
    .pc-card{ grid-template-columns: 1fr 2px 320px; }
  }
  @media (max-width: 760px){
    .pc-card{ grid-template-columns: 1fr; grid-template-rows:auto 2px auto; }
    .pc-divider{ width:100%; height:2px; }
    .pc-right{ grid-template-rows: 70px auto; }
  }
  

  /* Prevent stray elements from causing horizontal page scroll */
html, body { overflow-x: hidden; }

/* --- Site layout: main + aside --- */
main{
  display:grid;
  grid-template-columns: minmax(0, 1fr) minmax(280px, 360px); /* content | right panel */
  gap: 16px;
}

/* When width is tight, stack the aside under the viz */
@media (max-width: 1200px){
  main{ grid-template-columns: 1fr; }
  aside{ order: 2; }
}

/* Cards fill their column and never overflow */
.card.viz, .pc-stage, .pc-viewport, .pc-track { max-width: 100%; }

/* --- Fluid type & spacing (applies to all pages) --- */
:root{
  --step-0: clamp(14px, 0.35vw + 12px, 17px);
  --step-1: clamp(18px, 0.6vw + 14px, 22px);
  --step-2: clamp(22px, 0.9vw + 16px, 28px);
  --step-3: clamp(28px, 1.4vw + 18px, 36px);

  --space-1: clamp(8px, 0.6vw, 12px);
  --space-2: clamp(12px, 1vw, 18px);
  --space-3: clamp(16px, 1.6vw, 24px);
}
h1{ font-size: var(--step-3); }
h3{ font-size: var(--step-2); }
p, li, select, button{ font-size: var(--step-0); }
.card{ padding: var(--space-2); }

/* --- Carousel specifics (keeps everything inside the column) --- */
.pc-stage{ width: 100%; }
.pc-viewport{
  overflow-x:auto; overflow-y:hidden;
  scroll-snap-type:x mandatory;
  scroll-behavior:smooth;
  scrollbar-width:none;
  width:100%;
}
.pc-viewport::-webkit-scrollbar{ display:none; }
.pc-track{ display:flex; gap: 16px; padding: 16px; box-sizing: border-box; }

/* Each card is exactly the width of the carousel column */
.pc-card{
  flex: 0 0 100%;
  max-width: 100%;
  box-sizing: border-box;

  /* Right column scales with screen; never too big or too small */
  display:grid;
  grid-template-columns: 1fr 2px clamp(240px, 32vw, 420px);
}

/* Tighter on tablets/phones */
@media (max-width: 980px){
  .pc-card{ grid-template-columns: 1fr 2px clamp(220px, 38vw, 320px); }
}
@media (max-width: 760px){
  .pc-card{ grid-template-columns: 1fr; grid-template-rows:auto 2px auto; }
  .pc-divider{ width:100%; height:2px; }
}

/* On large screens, give the visualization more room than the side panel */
@media (min-width: 1280px){
    main{
      grid-template-columns: minmax(0, 1.35fr) minmax(280px, 340px);
    }
  }
  
/* Right column layout: title/meta first, then big hero image */
.pc-right {
    display: flex;
    flex-direction: column;
    gap: 14px;
  }
  
  /* Large responsive image under the title */
  .pc-hero {
    width: 100%;
    /* choose an aspect ratio you like; 16/9 feels cinematic, 4/3 is classic */
    aspect-ratio: 16 / 9;
    background-size: cover;
    background-position: center;
    border-radius: 14px;
    box-shadow: 0 6px 24px rgba(0,0,0,0.08);
  }
  
  .pc-hero.pc-hero-ph {
    background: linear-gradient(135deg, #eef2ff, #e0e7ff);
  }
  
  /* On very narrow screens, give the image a bit more height */
  @media (max-width: 720px) {
    .pc-hero { aspect-ratio: 4 / 3; }
  }
  